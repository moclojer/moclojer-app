shadow$provide.module$node_modules$$mswjs$interceptors$lib$Interceptor=function(global,require,module,exports){function getGlobalSymbol(symbol){return globalThis[symbol]||void 0}function deleteGlobalSymbol(symbol){delete globalThis[symbol]}var __values=this&&this.__values||function(o){var s="function"===typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"===typeof o.length)return{next:function(){o&&i>=o.length&&(o=void 0);return{value:o&&o[i++],done:!o}}};throw new TypeError(s?
"Object is not iterable.":"Symbol.iterator is not defined.");};Object.defineProperty(exports,"__esModule",{value:!0});exports.Interceptor=exports.InterceptorReadyState=exports.deleteGlobalSymbol=exports.getGlobalSymbol=void 0;var debug_1=require("module$node_modules$debug$src$browser"),AsyncEventEmitter_1=require("module$node_modules$$mswjs$interceptors$lib$utils$AsyncEventEmitter"),nextTick_1=require("module$node_modules$$mswjs$interceptors$lib$utils$nextTick");exports.getGlobalSymbol=getGlobalSymbol;
exports.deleteGlobalSymbol=deleteGlobalSymbol;var InterceptorReadyState;(function(InterceptorReadyState){InterceptorReadyState.IDLE="IDLE";InterceptorReadyState.APPLYING="APPLYING";InterceptorReadyState.APPLIED="APPLIED";InterceptorReadyState.DISPOSING="DISPOSING";InterceptorReadyState.DISPOSED="DISPOSED"})(InterceptorReadyState=exports.InterceptorReadyState||(exports.InterceptorReadyState={}));global=function(){function Interceptor(symbol){this.symbol=symbol;this.readyState=InterceptorReadyState.IDLE;
this.emitter=new AsyncEventEmitter_1.AsyncEventEmitter;this.subscriptions=[];this.log=debug_1.debug(symbol.description);this.emitter.setMaxListeners(0);this.log("constructing the interceptor...")}Interceptor.prototype.checkEnvironment=function(){return!0};Interceptor.prototype.apply=function(){var _this=this,log=this.log.extend("apply");log("applying the interceptor...");if(this.readyState===InterceptorReadyState.APPLIED)log("intercepted already applied!");else if(this.checkEnvironment()){this.readyState=
InterceptorReadyState.APPLYING;this.emitter.activate();log("activated the emiter!",this.emitter.readyState);var runningInstance=this.getInstance();runningInstance?(log("found a running instance, reusing..."),this.on=function(event,listener){log('proxying the "%s" listener',event);runningInstance.emitter.addListener(event,listener);_this.subscriptions.push(function(){runningInstance.emitter.removeListener(event,listener);log('removed proxied "%s" listener!',event)})}):(log("no running instance found, setting up a new instance..."),
this.setup(),this.setInstance());nextTick_1.nextTick(function(){_this.readyState=InterceptorReadyState.APPLIED})}else log("the interceptor cannot be applied in this environment!")};Interceptor.prototype.setup=function(){};Interceptor.prototype.on=function(event,listener){var log=this.log.extend("on");this.readyState===InterceptorReadyState.DISPOSING||this.readyState===InterceptorReadyState.DISPOSED?log("cannot listen to events, already disposed!"):(log('adding "%s" event listener:',event,listener.name),
this.emitter.on(event,listener))};Interceptor.prototype.dispose=function(){var _a,_this=this,log=this.log.extend("dispose");if(this.readyState===InterceptorReadyState.DISPOSED)log("cannot dispose, already disposed!");else if(log("disposing the interceptor..."),this.readyState=InterceptorReadyState.DISPOSING,this.getInstance()){this.clearInstance();log("global symbol deleted:",getGlobalSymbol(this.symbol));if(0<this.subscriptions.length){log("disposing of %d subscriptions...",this.subscriptions.length);
try{for(var _b=__values(this.subscriptions),_c=_b.next();!_c.done;_c=_b.next()){var dispose=_c.value;dispose()}}catch(e_1_1){var e_1={error:e_1_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_1)throw e_1.error;}}this.subscriptions=[];log("disposed of all subscriptions!",this.subscriptions.length)}this.emitter.deactivate();log("destroyed the listener!");nextTick_1.nextTick(function(){_this.readyState=InterceptorReadyState.DISPOSED})}else log("no interceptors running, skipping dispose...")};
Interceptor.prototype.getInstance=function(){var _a,instance=getGlobalSymbol(this.symbol);this.log("retrieved global instance:",null===(_a=null===instance||void 0===instance?void 0:instance.constructor)||void 0===_a?void 0:_a.name);return instance};Interceptor.prototype.setInstance=function(){globalThis[this.symbol]=this;this.log("set global instance!",this.symbol.description)};Interceptor.prototype.clearInstance=function(){deleteGlobalSymbol(this.symbol);this.log("cleared global instance!",this.symbol.description)};
return Interceptor}();exports.Interceptor=global}
//# sourceMappingURL=module$node_modules$$mswjs$interceptors$lib$Interceptor.js.map
