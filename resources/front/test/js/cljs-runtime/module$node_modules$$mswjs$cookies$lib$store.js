shadow$provide.module$node_modules$$mswjs$cookies$lib$store=function(global,require,module,exports){function supportsLocalStorage(){try{if(null==localStorage)return!1;const testKey=exports.PERSISTENCY_KEY+"_test";localStorage.setItem(testKey,"test");localStorage.getItem(testKey);localStorage.removeItem(testKey);return!0}catch(error){return!1}}var __rest=this&&this.__rest||function(s,e){var t={},p;for(p in s)Object.prototype.hasOwnProperty.call(s,p)&&0>e.indexOf(p)&&(t[p]=s[p]);if(null!=s&&"function"===
typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)0>e.indexOf(p[i])&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};Object.defineProperty(exports,"__esModule",{value:!0});exports.store=exports.PERSISTENCY_KEY=void 0;const set_cookie_parser_1=require("module$node_modules$set_cookie_parser$lib$set_cookie");exports.PERSISTENCY_KEY="MSW_COOKIE_STORE";class CookieStore{constructor(){this.store=new Map}add(request,response){if("omit"!==
request.credentials){var requestUrl=new URL(request.url);if(request=response.headers.get("set-cookie")){var now=Date.now();request=set_cookie_parser_1.parse(request).map(_a=>{var {maxAge}=_a;_a=__rest(_a,["maxAge"]);return Object.assign(Object.assign({},_a),{expires:void 0===maxAge?_a.expires:new Date(now+1E3*maxAge),maxAge})});var prevCookies=this.store.get(requestUrl.origin)||new Map;request.forEach(cookie=>{this.store.set(requestUrl.origin,prevCookies.set(cookie.name,cookie))})}}}get(request){this.deleteExpiredCookies();
const requestUrl=new URL(request.url),originCookies=this.store.get(requestUrl.origin)||new Map;switch(request.credentials){case "include":if("undefined"===typeof document)return originCookies;set_cookie_parser_1.parse(document.cookie).forEach(cookie=>{originCookies.set(cookie.name,cookie)});return originCookies;case "same-origin":return originCookies;default:return new Map}}getAll(){this.deleteExpiredCookies();return this.store}deleteAll(request){request=new URL(request.url);this.store.delete(request.origin)}clear(){this.store.clear()}hydrate(){if(supportsLocalStorage()){var persistedCookies=
localStorage.getItem(exports.PERSISTENCY_KEY);if(persistedCookies)try{JSON.parse(persistedCookies).forEach(([origin,cookies])=>{this.store.set(origin,new Map(cookies.map(_a=>{var [token,_b]=_a;({expires:_a}=_b);var cookie=__rest(_b,["expires"]);return[token,void 0===_a?cookie:Object.assign(Object.assign({},cookie),{expires:new Date(_a)})]})))})}catch(error){console.warn(`
[virtual-cookie] Failed to parse a stored cookie from the localStorage (key "${exports.PERSISTENCY_KEY}").

Stored value:
${localStorage.getItem(exports.PERSISTENCY_KEY)}

Thrown exception:
${error}

Invalid value has been removed from localStorage to prevent subsequent failed parsing attempts.`),localStorage.removeItem(exports.PERSISTENCY_KEY)}}}persist(){if(supportsLocalStorage()){var serializedCookies=Array.from(this.store.entries()).map(([origin,cookies])=>[origin,Array.from(cookies.entries())]);localStorage.setItem(exports.PERSISTENCY_KEY,JSON.stringify(serializedCookies))}}deleteExpiredCookies(){const now=Date.now();this.store.forEach((originCookies,origin)=>{originCookies.forEach(({expires,
name})=>{void 0!==expires&&expires.getTime()<=now&&originCookies.delete(name)});0===originCookies.size&&this.store.delete(origin)})}}exports.store=new CookieStore}
//# sourceMappingURL=module$node_modules$$mswjs$cookies$lib$store.js.map
